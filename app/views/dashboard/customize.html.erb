<script type="text/javascript">
	function checkOverflow(ID) {
		element = document.getElementById(ID);
		if( element.offsetHeight < element.scrollHeight ) {
			$("#"+ID + ' .ellipsis').show();
		}
	}
</script>
<div class="card" id="content_card">
	<div class="head">
		<% if @folder %>
		<h3><span onclick="redirectFolder('first')">Libary</span> <% if @folder.content_folder %><% if @folder.content_folder.content_folder %><i class="fas fa-caret-right"></i> <span>...</span> <% end %><i class="fas fa-caret-right"></i> <span onclick="redirectFolder('<%= @folder.content_folder_id %>')"><%= @folder.content_folder.name %></span> <% end %><i class="fas fa-caret-right"></i> <span><%= @folder.name %></span></h3>
		<% else %>
		<h3>Text, Video oder Bild hinzuf√ºgen!</h3>
		<% end %>
	</div>
	<div id="scrollcontent">
	<% if @folders.count != 0 %>
	<div class="folders">
		<h3>Ordner</h3>
		<% @folders.each do |f| %>
			<div class="card" onclick="redirectFolder('<%= f.id %>')">
				<%= image_tag 'dash/icons/folder.svg' %>
				<div class="title" id="title_<%= f.id %>"><%= f.name %><div class="ellipsis">...</div></div>
				<div class="author"><%= f.user ? f.user.fname[0] + '. ' + f.user.lname : '' %></div>
			</div>
		<% end %>
		<script type="text/javascript">
			<% @folders.each do |f| %>
				checkOverflow('title_<%= f.id %>');
			<% end %>
		</script>
	</div>
	<% end %>
	<% if @files.count != 0 %>
	<div class="files">
		<h3>Dateien</h3>
		<% @files.each do |f| %>
			<div class="card">
				<div class="thumb">
						<% if f.media_type == 'video' %>
							<%= image_tag f.video.thumb.url,  class: 'image' %>
							<i class="fas fa-play-circle"></i>
						<% elsif f.media_type == 'image' %>
							<% if f.image.present? %>
							<%= image_tag f.image.url,  class: 'image' %>
							<% end %>
						<% end %>

				</div>
				<div class="text">
						<div class="title" id="media_title_<%= f.id %>"><%= f.title? ? f.title : f.tasks.first&.title %><div class="ellipsis">...</div></div>
						<div class="time"><%= image_tag 'dash/video-icon.png' %><%= (f.duration / 60).to_s + ':' + (f.duration % 60).to_s %> - <%= f.user ? f.user.fname[0] + '. ' + f.user.lname : '' %></div>
				</div>

			</div>
			<script type="text/javascript">
				checkOverflow('media_title_<%= f.id %>');
			</script>
		<% end %>
	</div>
	<% end %>
	</div>
</div>
<script type="text/javascript">
	new PerfectScrollbar('#scrollcontent');
	function redirectFolder(fID) {
		if ( fID == 'first' ) {
			var URL = "<%= dashboard_customize_path %>";
		} else {
			var URL = "<%= dashboard_customize_path %>?folder_id=" + fID;
		}
		location.replace(URL);
	}

</script>
